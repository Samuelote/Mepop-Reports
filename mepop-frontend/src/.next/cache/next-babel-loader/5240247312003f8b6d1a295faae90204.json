{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { withFirebase } from '../../firebase';\nimport { useState, useCallback, useEffect } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport styled from 'styled-components';\nimport Card from '../../styles/elements/Card';\nimport Flex from '../../styles/layout/Flex';\nimport Button from '../../styles/elements/Button';\nimport Tooltip from '../../styles/elements/Tooltip';\nimport Text from '../../styles/elements/Text';\nimport { fetchFiles } from '../../store/actions/files';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Spinner from '../../styles/elements/Loading/Spinner';\nimport InfoModal from './InfoModal';\nimport { useToasts } from 'react-toast-notifications';\nvar Dropzone = withFirebase(function (_ref) {\n  var firebase = _ref.firebase;\n  var dispatch = useDispatch();\n\n  var _useToasts = useToasts(),\n      addToast = _useToasts.addToast;\n\n  var _useSelector = useSelector(function (state) {\n    return state.generalReducer;\n  }),\n      files = _useSelector.files;\n\n  var _useState = useState(files.length),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var _useState2 = useState(false),\n      buttonDisable = _useState2[0],\n      disableBtns = _useState2[1];\n\n  var _useState3 = useState(null),\n      activeBtn = _useState3[0],\n      activateBtn = _useState3[1];\n\n  var _useState4 = useState(false),\n      modalIsOpen = _useState4[0],\n      toggleModal = _useState4[1];\n\n  var startFetch = useCallback(function () {\n    var load = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    if (load) setLoading(true);\n    disableBtns(true);\n    fetchFiles({\n      firebase: firebase,\n      dispatch: dispatch\n    }, function () {\n      setLoading(false);\n      disableBtns(false);\n      activateBtn(null);\n    });\n  }, []);\n  useEffect(function () {\n    setLoading(true);\n    startFetch();\n  }, [startFetch]);\n\n  var onError = function onError(msg, dismiss) {\n    addToast(__jsx(\"div\", null, msg || 'Error Occurred'), {\n      appearance: 'error',\n      autoDismiss: dismiss\n    });\n    setLoading(false);\n    disableBtns(false);\n  };\n\n  var onDrop = useCallback(function (acceptedFiles) {\n    if (acceptedFiles.length) {\n      firebase.uploadFiles(acceptedFiles, startFetch, onError);\n    } else {\n      onError('File appears to be of wrong format.', true);\n    }\n  }, []);\n\n  var _useDropzone = useDropzone({\n    onDrop: onDrop,\n    accept: '.csv'\n  }),\n      getRootProps = _useDropzone.getRootProps,\n      getInputProps = _useDropzone.getInputProps,\n      isDragActive = _useDropzone.isDragActive;\n\n  var deleteFile = function deleteFile(filename) {\n    firebase.deleteFile(filename, function (file) {\n      // success! Now remove that file from local state or refresh files in some way.\n      startFetch(false);\n    });\n  };\n\n  return __jsx(Container, null, __jsx(InfoModal, {\n    modalIsOpen: modalIsOpen,\n    toggleModal: toggleModal\n  }), __jsx(Flex, {\n    justifyContent: \"flex-end\",\n    px: \"10px\"\n  }, __jsx(Tooltip, {\n    title: \"What's this?\"\n  }, __jsx(Button, {\n    bg: \"transparent\",\n    color: \"greyDarkest\",\n    fontSize: \"20px\",\n    onClick: function onClick() {\n      return toggleModal(!modalIsOpen);\n    }\n  }, __jsx(\"i\", {\n    className: \"fa fa-question-circle\"\n  })))), __jsx(DropZone, _extends({\n    isDragActive: isDragActive\n  }, getRootProps()), __jsx(\"input\", getInputProps()), __jsx(H2, null, \"Drop files here\"), __jsx(\"p\", null, \"or\"), __jsx(Button, {\n    color: \"blue\",\n    bg: \"white\",\n    size: \"lg\"\n  }, \"Select Files\"), __jsx(\"p\", null, \"Files must be from Depop to be valid\")), __jsx(Card, {\n    headerContent: \"Uploaded Files\",\n    isLoading: loading,\n    minHeight: \"200px\",\n    mb: \"100px\"\n  }, files.length ? __jsx(Table, null, files.map(function (_ref2, i) {\n    var filename = _ref2.filename;\n    return __jsx(Row, {\n      key: i,\n      index: i\n    }, __jsx(Tooltip, {\n      title: \"Delete file\",\n      arrow: false,\n      position: \"right\"\n    }, __jsx(DeleteBtn, {\n      disabled: buttonDisable,\n      \"aria-label\": \"Click to delete \".concat(filename),\n      onClick: function onClick() {\n        deleteFile(filename);\n        activateBtn(i);\n      }\n    }, buttonDisable && activeBtn === i ? __jsx(Spinner, {\n      width: \"9px\",\n      color: \"red\",\n      size: \"2\"\n    }) : __jsx(\"i\", {\n      className: \"fa fa-close\"\n    }))), filename);\n  })) : __jsx(Text, {\n    fontSize: \"20px\",\n    pt: \"1em\",\n    color: \"greyDark\"\n  }, \"Upload Files Above\")));\n});\nexport default Dropzone;\nvar Container = styled.div.withConfig({\n  displayName: \"FileDrop__Container\",\n  componentId: \"sc-3bbzl8-0\"\n})([\"width:100%;\"]);\nvar DropZone = styled(Flex).withConfig({\n  displayName: \"FileDrop__DropZone\",\n  componentId: \"sc-3bbzl8-1\"\n})([\"justify-content:center;align-items:center;flex-direction:column;display:flex;justify-content:center;align-items:center;margin:15px;min-height:250px;margin-top:10px;transition:.2s;position:relative;border:5px dashed \", \";border-radius:\", \";\"], function (_ref3) {\n  var theme = _ref3.theme,\n      isDragActive = _ref3.isDragActive;\n  return isDragActive ? theme.colors.greyDark : theme.colors.greyLight;\n}, function (_ref4) {\n  var theme = _ref4.theme,\n      isDragActive = _ref4.isDragActive;\n  return isDragActive ? theme.borderRadius.more : theme.borderRadius.normal;\n});\nvar H2 = styled.h2.withConfig({\n  displayName: \"FileDrop__H2\",\n  componentId: \"sc-3bbzl8-2\"\n})([\"margin:0;margin-top:10px;font-weight:\", \";\"], function (_ref5) {\n  var theme = _ref5.theme;\n  return theme.fontWeights.regular;\n});\nvar Row = styled.div.withConfig({\n  displayName: \"FileDrop__Row\",\n  componentId: \"sc-3bbzl8-3\"\n})([\"display:flex;align-items:center;width:100%;padding:3px 0px 3px 5px;border-bottom:\", \" 1px solid;\"], function (_ref6) {\n  var theme = _ref6.theme,\n      key = _ref6.key;\n  return theme.colors.mainBg;\n});\nvar DeleteBtn = styled.button.withConfig({\n  displayName: \"FileDrop__DeleteBtn\",\n  componentId: \"sc-3bbzl8-4\"\n})([\"margin-right:5px;cursor:pointer;color:\", \";height:25px;width:25px;display:flex;justify-content:center;align-items:center;flex-direction &:hover{color:\", \";}\"], function (_ref7) {\n  var theme = _ref7.theme;\n  return theme.colors.red;\n}, function (_ref8) {\n  var theme = _ref8.theme;\n  return theme.colors.redDark;\n});\nvar Table = styled.div.withConfig({\n  displayName: \"FileDrop__Table\",\n  componentId: \"sc-3bbzl8-5\"\n})([\"max-height:250px;overflow:auto;width:100%;\"]);","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport moment from 'moment';\nimport currency from 'currency.js';\nexport var getProfitsByMonth = function getProfitsByMonth(data) {\n  var months = {};\n  var monthArray = [];\n  data.sales.forEach(function (_ref) {\n    var date_of_sale = _ref.date_of_sale,\n        item_price = _ref.item_price,\n        depop_fee = _ref.depop_fee,\n        depop_payments_fee = _ref.depop_payments_fee,\n        usps_cost = _ref.usps_cost;\n    var month = moment(date_of_sale).format('MMM');\n    var date = moment(date_of_sale).format('MM/DD/yyyy');\n    var fees = cleanNumber(depop_fee) + cleanNumber(depop_payments_fee);\n    var sellerPaidShipping = cleanNumber(usps_cost);\n    var netProfit = currency(cleanNumber(item_price) - fees - sellerPaidShipping).value;\n\n    if (months[month]) {\n      months[month] = _objectSpread(_objectSpread({}, months[month]), {}, {\n        net: currency(netProfit + months[month].net).value,\n        depop_fees: currency(fees + months[month].depop_fees).value,\n        sellerPaidShipping: currency(sellerPaidShipping + months[month].sellerPaidShipping).value\n      });\n    } else {\n      months[month] = {\n        net: netProfit || 0,\n        depop_fees: fees || 0,\n        sellerPaidShipping: sellerPaidShipping || 0\n      };\n    } // sets start dates\n\n\n    if (months[month].start) {\n      var start = new Date(months[month].start);\n      var current = date;\n      if (current < start) months[month].start = date;\n    } else months[month].start = date;\n\n    if (months[month].end) {\n      var end = new Date(months[month].end);\n      var _current = date;\n      if (_current > end) months[month].end = date;\n    } else months[month].end = date;\n\n    months[month].end = date;\n  });\n  Object.keys(months).forEach(function (key) {\n    monthArray.push({\n      month: key,\n      'Net Profit': months[key].net,\n      'Depop Fees': months[key].depop_fees,\n      'Seller-Paid-Shipping': months[key].sellerPaidShipping\n    });\n  });\n  return monthArray;\n}; // Value Box 1\n\nexport var getAvgProfits = function getAvgProfits(data) {\n  var monthlyProfit = getProfitsByMonth(data);\n  var avg = 0;\n  monthlyProfit.forEach(function (data) {\n    avg += data['Net Profit'];\n  });\n  avg = avg / monthlyProfit.length;\n  return {\n    monthly: currency(avg).value,\n    weekly: currency(avg / 4).value\n  };\n}; // Value Box 2\n\nexport var bestTimeToList = function bestTimeToList(data) {\n  var obj = {\n    sell: {},\n    list: {}\n  };\n  data.sales.forEach(function (_ref2) {\n    var date_of_listing = _ref2.date_of_listing,\n        date_of_sale = _ref2.date_of_sale;\n    var listDay = moment(date_of_listing).format('dddd');\n    if (obj.list[listDay]) obj.list[listDay] += 1;else obj.list[listDay] = 1;\n    var saleDay = moment(date_of_sale).format('dddd');\n    if (obj.sell[saleDay]) obj.sell[saleDay] += 1;else obj.sell[saleDay] = 1;\n  });\n  var _final = {\n    sell: [],\n    list: []\n  };\n  var topSellCount = 0;\n  var topListCount = 0;\n  Object.keys(obj.sell).forEach(function (key) {\n    if (obj.sell[key] === topSellCount) {\n      _final.sell.push(key);\n    } else if (obj.sell[key] > topSellCount) {\n      _final.sell = [key];\n      topSellCount = obj.sell[key];\n    }\n  });\n  Object.keys(obj.list).forEach(function (key) {\n    if (obj.list[key] === topListCount) {\n      _final.list.push(key);\n    } else if (obj.list[key] > topListCount) {\n      _final.list = [key];\n      topListCount = obj.list[key];\n    }\n  });\n  return _final;\n}; // Value Box 3\n\nexport var avgItemsPerDay = function avgItemsPerDay(data) {\n  var obj = {};\n  data.sales.forEach(function (_ref3) {\n    var date_of_sale = _ref3.date_of_sale;\n\n    if (obj[date_of_sale]) {\n      obj[date_of_sale] += 1;\n    } else obj[date_of_sale] = 1;\n  });\n  var sales = data.sales.length;\n  var days = Object.keys(obj).length;\n  return sales / days;\n}; // Tables\n// export const formatSalesTable = (sales) => {\n//   const newSales = []\n//   sales.forEach((sale) => {\n//     const ms = new Date(sale.date_of_sale).getTime() - new Date(sale.date_of_listing).getTime()\n//     const days = ms / (1000 * 3600 * 24)\n//     newSales.push({\n//       ...sale,\n//       'date sold': moment(sale.date_of_sale).format('MM/DD/YYYY'),\n//       buyer: `${sale.name}`,\n//       username: `${sale.buyer}`,\n//       'item price': sale.item_price,\n//       'buyer-paid-shipping': sale.buyer_shipping_cost,\n//       fees: sale.depop_fee,\n//       'date listed': moment(sale.date_of_listing).format('MM/DD/YYYY'),\n//       'days listed': days, // converts from ms to days\n//       'item description': formatDescription(sale.description),\n//       address: `${sale.address_line_1} ${sale.city}, ${sale.state ? sale.state : ''} ${sale.post_code}`\n//     })\n//   })\n//   return sort(newSales)\n// }\n// utils\n// const sort = (sales) => {\n//   return sales.sort((a, b) => {\n//     const date1 = new Date(a['date sold'])\n//     const date2 = new Date(b['date listing'])\n//     return date1 - date2\n//   })\n// }\n// const formatDescription = (text) => {\n//   const tagStart = text.lastIndexOf('{')\n//   const withoutTags = tagStart !== -1 ? text.substring(0, tagStart) : text\n//   return withoutTags\n// }\n\nvar cleanNumber = function cleanNumber(num) {\n  if (!num || num === '-') return 0;\n  var withoutCurrency = num.substring(1, num.length);\n  return parseFloat(withoutCurrency);\n};","map":null,"metadata":{},"sourceType":"module"}
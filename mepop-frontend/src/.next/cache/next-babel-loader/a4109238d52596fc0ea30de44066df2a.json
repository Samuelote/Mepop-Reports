{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport moment from 'moment';\nimport currency from 'currency.js';\nimport theme from '../../../theme';\nexport var groupByDay = function groupByDay(data) {\n  var groupedData = {\n    Sun: {\n      sales: 0,\n      listings: 0\n    },\n    Mon: {\n      sales: 0,\n      listings: 0\n    },\n    Tue: {\n      sales: 0,\n      listings: 0\n    },\n    Wed: {\n      sales: 0,\n      listings: 0\n    },\n    Thu: {\n      sales: 0,\n      listings: 0\n    },\n    Fri: {\n      sales: 0,\n      listings: 0\n    },\n    Sat: {\n      sales: 0,\n      listings: 0\n    }\n  };\n  var newData = [];\n\n  if (data.sales) {\n    // groups data\n    data.sales.forEach(function (file) {\n      var saleDay = moment(file.date_of_sale, 'MM/DD/YYYY').format('ddd');\n      var listingDay = moment(file.date_of_listing, 'MM/DD/YYYY').format('ddd');\n      groupedData[listingDay].listings++;\n      groupedData[saleDay].sales++;\n    }); // sets up data in recharts format\n\n    Object.keys(groupedData).forEach(function (key) {\n      newData.push({\n        Day: key,\n        'Items Sold': groupedData[key].sales,\n        'Items Listed': groupedData[key].listings\n      });\n    });\n  }\n\n  return newData;\n};\nexport var groupByDate = function groupByDate(data, showEmptyDates) {\n  var newData = [];\n\n  if (data.sales) {\n    data.sales.forEach(function (_ref) {\n      var date_of_sale = _ref.date_of_sale,\n          total = _ref.total,\n          buyer_shipping_cost = _ref.buyer_shipping_cost,\n          usps_cost = _ref.usps_cost;\n      var gross = currency(total).value;\n      var net = gross - currency(buyer_shipping_cost).value - currency(usps_cost).value;\n      var latest = newData[newData.length - 1];\n\n      if (!newData.length || latest['Date Sold'] !== date_of_sale) {\n        if (latest && showEmptyDates) {\n          var milisecs = new Date(moment(date_of_sale, 'MM-DD-YYYY').format()).getTime() - new Date(moment(latest['Date Sold'], 'MM-DD-YYYY').format()).getTime();\n          var diff = milisecs / (1000 * 3600 * 24);\n\n          if (diff !== 1) {\n            for (var i = 1; i < diff; i++) {\n              var day = new Date(moment(latest['Date Sold'], 'MM-DD-YYYY').format()).getDate() + i;\n              var date = new Date(moment(latest['Date Sold'], 'MM-DD-YYYY').format());\n              var formatted = moment(date.setDate(day)).format('MM-DD-YYYY');\n              newData.push({\n                'Date Sold': formatted,\n                'Items Sold': 0,\n                Gross: 0,\n                Net: 0\n              });\n            }\n          }\n        }\n\n        newData.push({\n          'Date Sold': date_of_sale,\n          'Items Sold': 1,\n          Gross: gross,\n          Net: net\n        });\n      } else {\n        latest['Items Sold'] += 1;\n        latest.Net += net;\n        latest.Gross += gross;\n      }\n    });\n  }\n\n  return newData;\n};\nexport var groupByTime = function groupByTime(data) {\n  // const groupedData = {}\n  var newData = [[], [], [], [], [], [], []].fill(0).map(function () {\n    return new Array(24).fill(0);\n  });\n  var obj = {\n    sun: [],\n    mon: [],\n    tue: [],\n    wed: [],\n    thu: [],\n    fri: [],\n    sat: []\n  };\n\n  if (data.sales) {\n    // groups data\n    data.sales.forEach(function (sale) {\n      var hourIndex = moment(sale.time_of_sale, 'hh:mm A').format('H');\n      var day = moment(sale.date_of_sale).format('ddd').toLowerCase();\n\n      if (obj[day][hourIndex]) {\n        obj[day][hourIndex].push(sale);\n      } else obj[day][hourIndex] = [sale]; // obj[day].push(sale)\n\n\n      switch (day) {\n        case 'sun':\n          {\n            newData[0][hourIndex] += 1;\n            break;\n          }\n\n        case 'mon':\n          {\n            newData[1][hourIndex] += 1;\n            break;\n          }\n\n        case 'tue':\n          {\n            newData[2][hourIndex] += 1;\n            break;\n          }\n\n        case 'wed':\n          {\n            newData[3][hourIndex] += 1;\n            break;\n          }\n\n        case 'thu':\n          {\n            newData[4][hourIndex] += 1;\n            break;\n          }\n\n        case 'fri':\n          {\n            newData[5][hourIndex] += 1;\n            break;\n          }\n\n        case 'sat':\n          {\n            newData[6][hourIndex] += 1;\n            break;\n          }\n      }\n    });\n  }\n\n  return {\n    arr: newData,\n    obj: obj\n  };\n};\nexport var groupByCategory = function groupByCategory(data, gross) {\n  var newData = [];\n  var allCategories = {};\n\n  if (data.sales) {\n    data.sales.forEach(function (_ref2) {\n      var category = _ref2.category,\n          total = _ref2.total;\n      var totalNum = currency(total).value;\n\n      if (allCategories[category]) {\n        allCategories[category].sold += 1;\n        allCategories[category].gross += totalNum;\n      } else allCategories[category] = {\n        sold: 1,\n        gross: totalNum\n      };\n    });\n  }\n\n  Object.keys(allCategories).forEach(function (key) {\n    newData.push({\n      Category: capitalize(key),\n      'Items Sold': allCategories[key].sold,\n      'Gross Earnings': allCategories[key].gross\n    });\n  });\n  newData.sort(function (a, b) {\n    return b['Items Sold'] - a['Items Sold'];\n  });\n  return newData.slice(0, 15);\n};\nexport var groupByPaymentType = function groupByPaymentType(data) {\n  var newData = [];\n  var paymentTypes = {};\n\n  if (data.sales) {\n    data.sales.forEach(function (_ref3) {\n      var payment_type = _ref3.payment_type,\n          total = _ref3.total;\n      var totalNum = currency(total).value;\n\n      if (paymentTypes[payment_type]) {\n        paymentTypes[payment_type].sold += 1;\n        paymentTypes[payment_type].gross += totalNum;\n      } else paymentTypes[payment_type] = {\n        sold: 1,\n        gross: totalNum\n      };\n    });\n  }\n\n  var colors = [theme.colors.pastelOrange, theme.colors.pastelRose, theme.colors.primary, theme.colors.pastelBlueLight];\n  Object.keys(paymentTypes).forEach(function (key, i) {\n    newData.push({\n      name: key === 'STRIPE' ? 'BANK ACCOUNT' : key,\n      sold: paymentTypes[key].sold,\n      gross: paymentTypes[key].gross,\n      color: colors[i]\n    });\n  });\n  return newData;\n};\nexport var groupByWeek = function groupByWeek(data, showEmptyDates) {\n  var newData = [];\n  var obj = {};\n\n  if (data.sales) {\n    data.sales.forEach(function (_ref4) {\n      var date_of_sale = _ref4.date_of_sale,\n          total = _ref4.total,\n          buyer_shipping_cost = _ref4.buyer_shipping_cost,\n          usps_cost = _ref4.usps_cost;\n\n      var _getDateInfo = getDateInfo(date_of_sale),\n          week = _getDateInfo.week,\n          month = _getDateInfo.month;\n\n      var currentWeek = \"\".concat(month, \" - Wk\").concat(week);\n      if (!obj[currentWeek]) obj[currentWeek] = {\n        Gross: 0,\n        Net: 0\n      };\n      var gross = currency(total).value;\n      var net = gross - currency(buyer_shipping_cost).value - currency(usps_cost).value;\n      obj[currentWeek].Gross += gross;\n      obj[currentWeek].Net += net;\n    });\n    Object.keys(obj).forEach(function (key) {\n      newData.push(_objectSpread({\n        week: key\n      }, obj[key]));\n    });\n  }\n\n  return newData;\n};\n\nfunction getDateInfo(date) {\n  var month = moment(date).format('MMM YYYY');\n  var nthOfMonth = Math.ceil(moment(date).date() / 7);\n  if (nthOfMonth >= 5) return {\n    week: 4,\n    month: month\n  };else return {\n    week: nthOfMonth,\n    month: month\n  };\n}\n\nfunction capitalize(str) {\n  str = str.split(' ');\n\n  for (var i = 0; i < str.length; i++) {\n    str[i] = str[i][0].toUpperCase() + str[i].substr(1);\n  }\n\n  return str.join(' ');\n}","map":{"version":3,"sources":["/Users/samuelwood/development/mepop-reports/mepop-frontend/src/components/reports/util/grouping.js"],"names":["moment","currency","theme","groupByDay","data","groupedData","Sun","sales","listings","Mon","Tue","Wed","Thu","Fri","Sat","newData","forEach","file","saleDay","date_of_sale","format","listingDay","date_of_listing","Object","keys","key","push","Day","groupByDate","showEmptyDates","total","buyer_shipping_cost","usps_cost","gross","value","net","latest","length","milisecs","Date","getTime","diff","i","day","getDate","date","formatted","setDate","Gross","Net","groupByTime","fill","map","Array","obj","sun","mon","tue","wed","thu","fri","sat","sale","hourIndex","time_of_sale","toLowerCase","arr","groupByCategory","allCategories","category","totalNum","sold","Category","capitalize","sort","a","b","slice","groupByPaymentType","paymentTypes","payment_type","colors","pastelOrange","pastelRose","primary","pastelBlueLight","name","color","groupByWeek","getDateInfo","week","month","currentWeek","nthOfMonth","Math","ceil","str","split","toUpperCase","substr","join"],"mappings":"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","sourcesContent":["import moment from 'moment'\nimport currency from 'currency.js'\nimport theme from '../../../theme'\n\nexport const groupByDay = (data) => {\n  const groupedData = {\n    Sun: { sales: 0, listings: 0 },\n    Mon: { sales: 0, listings: 0 },\n    Tue: { sales: 0, listings: 0 },\n    Wed: { sales: 0, listings: 0 },\n    Thu: { sales: 0, listings: 0 },\n    Fri: { sales: 0, listings: 0 },\n    Sat: { sales: 0, listings: 0 }\n  }\n  const newData = []\n  if (data.sales) {\n    // groups data\n    data.sales.forEach((file) => {\n      const saleDay = moment(file.date_of_sale, 'MM/DD/YYYY').format('ddd')\n      const listingDay = moment(file.date_of_listing, 'MM/DD/YYYY').format('ddd')\n      groupedData[listingDay].listings++\n      groupedData[saleDay].sales++\n    })\n    // sets up data in recharts format\n    Object.keys(groupedData).forEach((key) => {\n      newData.push({ Day: key, 'Items Sold': groupedData[key].sales, 'Items Listed': groupedData[key].listings })\n    })\n  }\n  return newData\n}\n\nexport const groupByDate = (data, showEmptyDates) => {\n  const newData = []\n  if (data.sales) {\n    data.sales.forEach(({ date_of_sale, total, buyer_shipping_cost, usps_cost }) => {\n      const gross = currency(total).value\n      const net = gross - currency(buyer_shipping_cost).value - currency(usps_cost).value\n      const latest = newData[newData.length - 1]\n      if (!newData.length || latest['Date Sold'] !== date_of_sale) {\n        if (latest && showEmptyDates) {\n          const milisecs =\n              new Date(moment(date_of_sale, 'MM-DD-YYYY').format()).getTime() -\n              new Date(moment(latest['Date Sold'], 'MM-DD-YYYY').format()).getTime()\n          const diff = milisecs / (1000 * 3600 * 24)\n          if (diff !== 1) {\n            for (let i = 1; i < diff; i++) {\n              const day = new Date(moment(latest['Date Sold'], 'MM-DD-YYYY').format()).getDate() + i\n              const date = new Date(moment(latest['Date Sold'], 'MM-DD-YYYY').format())\n              const formatted = moment(date.setDate(day)).format('MM-DD-YYYY')\n\n              newData.push({ 'Date Sold': formatted, 'Items Sold': 0, Gross: 0, Net: 0 })\n            }\n          }\n        }\n\n        newData.push({ 'Date Sold': date_of_sale, 'Items Sold': 1, Gross: gross, Net: net })\n      } else {\n        latest['Items Sold'] += 1\n        latest.Net += net\n        latest.Gross += gross\n      }\n    })\n  }\n  return newData\n}\n\nexport const groupByTime = (data) => {\n  // const groupedData = {}\n  const newData = [[], [], [], [], [], [], []].fill(0)\n    .map(() => new Array(24).fill(0))\n  const obj = {\n    sun: [],\n    mon: [],\n    tue: [],\n    wed: [],\n    thu: [],\n    fri: [],\n    sat: []\n  }\n  if (data.sales) {\n    // groups data\n    data.sales.forEach((sale) => {\n      const hourIndex = moment(sale.time_of_sale, 'hh:mm A').format('H')\n      const day = moment(sale.date_of_sale).format('ddd').toLowerCase()\n      if (obj[day][hourIndex]) {\n        obj[day][hourIndex].push(sale)\n      } else obj[day][hourIndex] = [sale]\n      // obj[day].push(sale)\n      switch (day) {\n        case 'sun': {\n          newData[0][hourIndex] += 1\n          break\n        }\n        case 'mon': {\n          newData[1][hourIndex] += 1\n          break\n        }\n        case 'tue': {\n          newData[2][hourIndex] += 1\n          break\n        }\n        case 'wed': {\n          newData[3][hourIndex] += 1\n          break\n        }\n        case 'thu': {\n          newData[4][hourIndex] += 1\n          break\n        }\n        case 'fri': {\n          newData[5][hourIndex] += 1\n          break\n        }\n        case 'sat': {\n          newData[6][hourIndex] += 1\n          break\n        }\n      }\n    })\n  }\n  return { arr: newData, obj }\n}\n\nexport const groupByCategory = (data, gross) => {\n  const newData = []\n  const allCategories = {}\n  if (data.sales) {\n    data.sales.forEach(({ category, total }) => {\n      const totalNum = currency(total).value\n      if (allCategories[category]) {\n        allCategories[category].sold += 1\n        allCategories[category].gross += totalNum\n      } else allCategories[category] = { sold: 1, gross: totalNum }\n    })\n  }\n\n  Object.keys(allCategories).forEach((key) => {\n    newData.push({\n      Category: capitalize(key),\n      'Items Sold': allCategories[key].sold,\n      'Gross Earnings': allCategories[key].gross\n    })\n  })\n  newData.sort((a, b) => {\n    return b['Items Sold'] - a['Items Sold']\n  })\n  return newData.slice(0, 15)\n}\n\nexport const groupByPaymentType = (data) => {\n  const newData = []\n  const paymentTypes = {}\n  if (data.sales) {\n    data.sales.forEach(({ payment_type, total }) => {\n      const totalNum = currency(total).value\n      if (paymentTypes[payment_type]) {\n        paymentTypes[payment_type].sold += 1\n        paymentTypes[payment_type].gross += totalNum\n      } else paymentTypes[payment_type] = { sold: 1, gross: totalNum }\n    })\n  }\n  const colors = [theme.colors.pastelOrange, theme.colors.pastelRose, theme.colors.primary, theme.colors.pastelBlueLight]\n\n  Object.keys(paymentTypes).forEach((key, i) => {\n    newData.push({\n      name: key === 'STRIPE' ? 'BANK ACCOUNT' : key,\n      sold: paymentTypes[key].sold,\n      gross: paymentTypes[key].gross,\n      color: colors[i]\n    })\n  })\n\n  return newData\n}\n\nexport const groupByWeek = (data, showEmptyDates) => {\n  const newData = []\n  const obj = {}\n  if (data.sales) {\n    data.sales.forEach(({ date_of_sale, total, buyer_shipping_cost, usps_cost }) => {\n      const { week, month } = getDateInfo(date_of_sale)\n      const currentWeek = `${month} - Wk${week}`\n\n      if (!obj[currentWeek]) obj[currentWeek] = { Gross: 0, Net: 0 }\n\n      const gross = currency(total).value\n      const net = gross - currency(buyer_shipping_cost).value - currency(usps_cost).value\n      obj[currentWeek].Gross += gross\n      obj[currentWeek].Net += net\n    })\n    Object.keys(obj).forEach(key => {\n      newData.push({ week: key, ...obj[key] })\n    })\n  }\n  return newData\n}\n\nfunction getDateInfo (date) {\n  const month = moment(date).format('MMM YYYY')\n  var nthOfMonth = Math.ceil(moment(date).date() / 7)\n  if (nthOfMonth >= 5) return { week: 4, month }\n  else return { week: nthOfMonth, month }\n}\n\nfunction capitalize (str) {\n  str = str.split(' ')\n  for (let i = 0; i < str.length; i++) {\n    str[i] = str[i][0].toUpperCase() + str[i].substr(1)\n  }\n\n  return str.join(' ')\n}\n"]},"metadata":{},"sourceType":"module"}
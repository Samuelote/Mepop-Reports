{"ast":null,"code":"var _this = this,\n    _jsxFileName = \"/Users/samuelwood/development/mepop-reports/mepop-frontend/src/components/reports/SalesMap/index.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect, memo } from 'react';\nimport _ from 'lodash';\nimport { useSelector } from 'react-redux';\nimport GoogleMapReact from 'google-map-react';\nimport styled from 'styled-components';\nimport Card from '../../../styles/elements/Card';\nimport Tooltip from '../../../styles/elements/Tooltip';\nimport SalesTable from '../../general/SalesTable';\nimport SaleDetails from '../../general/SaleDetails';\nimport Flex from '../../../styles/layout/Flex';\nimport { getGeopoints } from '../util/geopoints';\nvar SalesMap = memo(_c = _s(function (_ref) {\n  _s();\n\n  var data = _ref.data,\n      styles = _ref.styles,\n      isBasic = _ref.isBasic;\n\n  var _useState = useState([]),\n      salesToMap = _useState[0],\n      setSalesToMap = _useState[1];\n\n  var _useState2 = useState({}),\n      salesToShow = _useState2[0],\n      setSalesToShow = _useState2[1];\n\n  var _useState3 = useState(null),\n      activeSale = _useState3[0],\n      activateSale = _useState3[1];\n\n  var _useSelector = useSelector(function (state) {\n    return state.generalReducer;\n  }),\n      googleMapsKey = _useSelector.googleMapsKey;\n\n  var _useState4 = useState([]),\n      geocodes = _useState4[0],\n      setGeocodes = _useState4[1];\n\n  useEffect(function () {\n    getGeopoints(data, function (res) {\n      setGeocodes(res);\n    });\n  }, [data]);\n  useEffect(function () {\n    return setSalesToMap(_.values(geocodes));\n  }, [geocodes]);\n  if (!googleMapsKey) return null;\n  return __jsx(Card, {\n    headerContent: \"Map of Sales (US only)\",\n    proOnly: isBasic ? {\n      component: 'Map of Sales (US only)',\n      img: 'sales-map.png'\n    } : null,\n    height: \"350px\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 5\n    }\n  }, __jsx(Flex, {\n    width: [1, 1, 1, 1],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }\n  }, __jsx(MapContainer, {\n    mini: salesToShow.sales,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 9\n    }\n  }, __jsx(GoogleMapReact, {\n    bootstrapURLKeys: {\n      key: googleMapsKey.key\n    },\n    defaultCenter: {\n      lat: 39,\n      lng: -98\n    },\n    defaultZoom: 0,\n    yesIWantToUseGoogleMapApiInternals: true,\n    gestureHandling: \"cooperative\",\n    options: {\n      gestureHandling: 'cooperative'\n    },\n    minWidth: \"500px\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 11\n    }\n  }, salesToMap.length ? salesToMap.map(function (zip, i) {\n    var _zip$geopoint = zip.geopoint,\n        lat = _zip$geopoint.lat,\n        lng = _zip$geopoint.lng;\n    if (getTitle(zip).includes('undefined')) return null; // this weeds out other countries\n\n    return __jsx(Marker, {\n      setSalesToShow: setSalesToShow,\n      activateSale: activateSale,\n      zip: zip,\n      key: i,\n      lat: lat,\n      lng: lng,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 19\n      }\n    });\n  }) : null)), salesToShow.sales && !activeSale ? __jsx(SalesTable, {\n    boxShadow: \"none\",\n    m: \"0\",\n    minWidth: \"50%\",\n    data: salesToShow,\n    currencyType: data.currency_type,\n    headerContent: getTitle(salesToShow),\n    handleRowClick: function handleRowClick(row, i) {\n      activateSale(row.rowData);\n    },\n    onClose: function onClose() {\n      return setSalesToShow({});\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }\n  }) : activeSale ? __jsx(SaleDetails, {\n    chartHeight: 200,\n    currencyType: data.currency_type,\n    boxShadow: \"none\",\n    m: \"0\",\n    minWidth: \"50%\",\n    onClose: function onClose() {\n      return activateSale(null);\n    },\n    row: activeSale,\n    getUrl: data.getUrl,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }\n  }) : null));\n}, \"/5QcpTeu0X+x+wgqt/Mp5Y5Uifk=\", false, function () {\n  return [useSelector];\n}));\n_c2 = SalesMap;\nexport default SalesMap;\nvar Marker = memo(_c3 = function _c3(_ref2) {\n  var zip = _ref2.zip,\n      setSalesToShow = _ref2.setSalesToShow,\n      activateSale = _ref2.activateSale;\n  return __jsx(Tooltip, {\n    offset: 40,\n    title: getTitle(zip),\n    hideOnClick: false,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 5\n    }\n  }, __jsx(I, {\n    className: \"fa fa-map-marker\",\n    onClick: function onClick() {\n      activateSale(null);\n      setSalesToShow(zip);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }\n  }));\n}); // utils\n\n_c4 = Marker;\n\nfunction getTitle(_ref3) {\n  var location = _ref3.location,\n      sales = _ref3.sales;\n  var title = \"\".concat(location.city, \", \").concat(location.state, \" \").concat(location.zip, \" - \").concat(sales.length);\n  return title;\n}\n\nvar MapContainer = styled.div.withConfig({\n  displayName: \"SalesMap__MapContainer\",\n  componentId: \"g1nti4-0\"\n})([\"visibility:visible;height:320px;width:100%;background:'black';transition:.2s;display:flex;\"]);\n_c5 = MapContainer;\nvar I = styled.i.withConfig({\n  displayName: \"SalesMap__I\",\n  componentId: \"g1nti4-1\"\n})([\"font-size:25px;cursor:pointer;color:\", \";&:hover{color:\", \"}\"], function (_ref4) {\n  var theme = _ref4.theme;\n  return theme.colors.pastelRose;\n}, function (_ref5) {\n  var theme = _ref5.theme;\n  return theme.colors.red;\n});\n_c6 = I;\n\nvar _c, _c2, _c3, _c4, _c5, _c6;\n\n$RefreshReg$(_c, \"SalesMap$memo\");\n$RefreshReg$(_c2, \"SalesMap\");\n$RefreshReg$(_c3, \"Marker$memo\");\n$RefreshReg$(_c4, \"Marker\");\n$RefreshReg$(_c5, \"MapContainer\");\n$RefreshReg$(_c6, \"I\");","map":{"version":3,"sources":["/Users/samuelwood/development/mepop-reports/mepop-frontend/src/components/reports/SalesMap/index.js"],"names":["useState","useEffect","memo","_","useSelector","GoogleMapReact","styled","Card","Tooltip","SalesTable","SaleDetails","Flex","getGeopoints","SalesMap","data","styles","isBasic","salesToMap","setSalesToMap","salesToShow","setSalesToShow","activeSale","activateSale","state","generalReducer","googleMapsKey","geocodes","setGeocodes","res","values","component","img","sales","key","lat","lng","gestureHandling","length","map","zip","i","geopoint","getTitle","includes","currency_type","row","rowData","getUrl","Marker","location","title","city","MapContainer","div","I","theme","colors","pastelRose","red"],"mappings":"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","sourcesContent":["import { useState, useEffect, memo } from 'react'\nimport _ from 'lodash'\nimport { useSelector } from 'react-redux'\nimport GoogleMapReact from 'google-map-react'\nimport styled from 'styled-components'\n\nimport Card from '../../../styles/elements/Card'\nimport Tooltip from '../../../styles/elements/Tooltip'\nimport SalesTable from '../../general/SalesTable'\nimport SaleDetails from '../../general/SaleDetails'\nimport Flex from '../../../styles/layout/Flex'\nimport { getGeopoints } from '../util/geopoints'\n\nconst SalesMap = memo(({ data, styles, isBasic }) => {\n  const [salesToMap, setSalesToMap] = useState([])\n  const [salesToShow, setSalesToShow] = useState({})\n  const [activeSale, activateSale] = useState(null)\n  const { googleMapsKey } = useSelector(state => state.generalReducer)\n  const [geocodes, setGeocodes] = useState([])\n\n  useEffect(() => {\n    getGeopoints(data, (res) => {\n      setGeocodes(res)\n    })\n  }, [data])\n\n  useEffect(() => {\n    return setSalesToMap(_.values(geocodes))\n  }, [geocodes])\n\n  if (!googleMapsKey) return null\n\n  return (\n    <Card\n      headerContent='Map of Sales (US only)'\n      proOnly={isBasic ? {\n        component: 'Map of Sales (US only)',\n        img: 'sales-map.png'\n      } : null}\n      height='350px'\n    >\n      <Flex width={[1, 1, 1, 1]}>\n        <MapContainer mini={salesToShow.sales}>\n          <GoogleMapReact\n            bootstrapURLKeys={{ key: googleMapsKey.key }}\n            defaultCenter={{ lat: 39, lng: -98 }}\n            defaultZoom={0}\n            yesIWantToUseGoogleMapApiInternals\n            gestureHandling='cooperative'\n            options={{ gestureHandling: 'cooperative' }}\n            minWidth='500px'\n          >\n            {salesToMap.length\n              ? salesToMap.map((zip, i) => {\n                const { geopoint: { lat, lng } } = zip\n                if (getTitle(zip).includes('undefined')) return null // this weeds out other countries\n                return (\n                  <Marker\n                    setSalesToShow={setSalesToShow}\n                    activateSale={activateSale}\n                    zip={zip}\n                    key={i}\n                    lat={lat}\n                    lng={lng}\n                  />\n                )\n              })\n              : null}\n\n          </GoogleMapReact>\n        </MapContainer>\n        {salesToShow.sales && !activeSale\n          ? (\n            <SalesTable\n              boxShadow='none'\n              m='0'\n              minWidth='50%'\n              data={salesToShow}\n              currencyType={data.currency_type}\n              headerContent={getTitle(salesToShow)}\n              handleRowClick={(row, i) => {\n                activateSale(row.rowData)\n              }}\n              onClose={() => setSalesToShow({})}\n            />\n          ) : activeSale ? (\n            <SaleDetails\n              chartHeight={200}\n              currencyType={data.currency_type}\n              boxShadow='none'\n              m='0'\n              minWidth='50%'\n              onClose={() => activateSale(null)}\n              row={activeSale}\n              getUrl={data.getUrl}\n            />\n          )\n            : null}\n      </Flex>\n    </Card>\n  )\n})\n\nexport default SalesMap\n\nconst Marker = memo(({ zip, setSalesToShow, activateSale }) => {\n  return (\n    <Tooltip\n      offset={40}\n      title={getTitle(zip)}\n      hideOnClick={false}\n    >\n      <I\n        className='fa fa-map-marker' onClick={() => {\n          activateSale(null)\n          setSalesToShow(zip)\n        }}\n      />\n    </Tooltip>)\n})\n\n// utils\nfunction getTitle ({ location, sales }) {\n  const title = `${location.city}, ${location.state} ${location.zip} - ${sales.length}`\n  return title\n}\n\nconst MapContainer = styled.div`\n  visibility: visible;\n  height: 320px;\n  width: 100%;\n  background: 'black';\n  transition: .2s;\n  display: flex;\n`\nconst I = styled.i`\n  font-size: 25px;\n  cursor: pointer;\n  color: ${({ theme }) => theme.colors.pastelRose};\n\n  &:hover {\n    color: ${({ theme }) => theme.colors.red}\n\n  }\n`\n"]},"metadata":{},"sourceType":"module"}